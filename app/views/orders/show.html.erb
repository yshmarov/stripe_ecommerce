<%= meta_tags(title: t(".title", name: @order.to_param.upcase)) %>

<%= turbo_stream_from @order %>

<div class="container mx-auto px-4 py-8">
  <% if !@order.draft? && !@order.done? %>
    <div class="alert alert-success mb-6">
      <i class="fa-solid fa-circle-check"></i>
      <h3 class="font-bold"><%= t(".thank_you") %></h3>
    </div>
  <% end %>

  <div class="card bg-base-100 shadow-xl mb-6">
    <div class="card-body">
      <%= render @order %>
    </div>
  </div>

  <%= render partial: "orders/checkout_details", locals: { order: @order } %>

  <% if @order.order_items.any? %>
    <div class="collapse collapse-arrow bg-base-200 mb-6">
      <input type="checkbox" checked /> 
      <div class="collapse-title text-xl font-medium">
        <%= t("orders.order.items").capitalize %>
      </div>
      <div class="collapse-content">
        <%= render @order_items %>
      </div>
    </div>
  <% end %>

  <% if @order.done? %>
    <div class="collapse collapse-arrow bg-base-200">
      <input type="checkbox" checked /> 
      <div class="collapse-title text-xl font-medium">
        <%= t(".rating") %>
      </div>
      <div class="collapse-content">
        <div class="flex justify-between items-center">
          <% rating_emojis.each do |rating, emoji| %>
            <%= button_to order_path(@order), 
                params: {order: { id: @order.id, rating: rating }}, 
                method: :put, 
                disabled: @order.rating.equal?(rating),
                class: "btn btn-ghost text-2xl #{@order.rating.equal?(rating) ? 'btn-active' : ''}" do %>
              <%= emoji %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
